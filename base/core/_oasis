#AUTOGENERATED FILE; EDIT oasis.sh INSTEAD

OASISFormat:  0.2
OCamlVersion: >= 3.12
Name:         core
Version:      107.01
Synopsis:     Jane Street Capital's standard library overlay
Authors:      Jane street capital
Copyrights:   (C) 2008-2010 Jane Street Capital LLC
License:      LGPL-2.1 with OCaml linking exception
LicenseFile:  LICENSE
Plugins:      StdFiles (0.2),
              DevFiles (0.2),
              META (0.2)
BuildTools:   ocamlbuild
Description:  Jane Street Capital's standard library overlay
FindlibVersion: >= 1.2.7
XStdFilesAUTHORS: false
XStdFilesINSTALLFilename: INSTALL
XStdFilesREADME: false


Flag linux
  Description: Enable linux specific extensions
  Default$:    system(linux) || system(linux_elf)

if flag(linux)
  PostConfCommand: lib/discover.sh lib/config.mlh lib/config.h -DLINUX_EXT
else
  PostConfCommand: lib/discover.sh lib/config.mlh lib/config.h

PreDistCleanCommand: $rm "lib/config.mlh" "lib/config.h"

Library core
  Path:               lib
  FindlibName:        core
  Pack:               true
  Modules:Agnostic_mutex,Algebraic_group,Array_permute,Avltree,Backtrace,Bag,Bigbuffer,Bigstring,Bigsubstring,Binable,Binary_packing,Blang,Bool,Bounded_int_table,Bucket,Byte_units,Caml,Common,Comparable,Constrained_float,Container,Core_arg,Core_array,Core_bin_prot,Core_char,Core_condition,Core_field,Core_filename,Core_gc,Core_hashtbl,Core_hashtbl_intf,Core_int,Core_int32,Core_int63,Core_int64,Core_list,Core_map,Core_map_intf,Core_mutex,Core_nativeint,Core_printexc,Core_printf,Core_queue,Core_random,Core_set,Core_set_intf,Core_sexp,Core_stack,Core_string,Core_sys,Core_thread,Core_unix,Crc,Daemon,Date,Default,Dequeue,Doubly_linked,Error,Exn,Float,Floatable,Float_intf,Float_robust_compare,Fn,Force_once,Fqueue,Hashable,Hash_heap,Hash_queue,Hash_set,Hash_set_intf,Heap,Host_and_port,Identifiable,In_channel,Inline_tests,Intable,Int_conversions,Interfaces,Interval,Interval_intf,Int_intf,Int_set,Linebuf,Lock_file,Make_substring,Memo,Monad,Month,Mutex0,Nano_mutex,No_polymorphic_compare,Ofday,Only_in_test,Option,Ordered_collection_common,Or_error,Out_channel,Pid,Piecewise_linear,Pretty_printer,Quickcheck,Ref,Result,Robustly_comparable,Set_once,Sexpable,Signal,Space_safe_tuple,Span,Squeue,Std,Std_internal,Stringable,String_id,Substring,Substring_intf,Sys_open_patch,T,Thread_safe_queue,Time,Time_internal,Timer,Tuple,Union_find,Unique_id,Unique_id_intf,Unit,Univ,Unpack_buffer,Weekday,With_return,Word_size,Zone
  #This should actually be the result of calling -D_LARGEFILE64_SOURCE
  CCOpt:              -D_LARGEFILE64_SOURCE
  #Hack to skip the compilation of linux_ext
  CSources:           config.h,backtrace_stubs.c,bigstring_stubs.c,config.h,includes.h,jane_common.h,linebuf_stubs.c,misc.c,ocaml_utils.h,ocaml_utils_macros.h,ocaml_utils_stubs.c,open_stubs.c,signal_stubs.c,socketaddr.h,unix_stubs.c,unix_utils.h
  #Disabled for now: those fields cannot be conditional...
  #if flag(linux)
    CSources+:        linux_ext_stubs.c,bigstring_marshal_stubs.c
    Modules+:         Linux_ext,Bigstring_marshal
  if flag(linux)
    CCLib:            -lrt
  BuildDepends:       sexplib.syntax,
                      sexplib,
                      fieldslib.syntax,
                      fieldslib,
                      bin_prot,
                      bin_prot.syntax,
                      bigarray,
                      res,
                      unix,
                      threads

Flag tests
  Description:        Build and run tests
  Default:            true

Executable test_runner
  Path:               lib_test
  MainIs:             test_runner.ml
  Build$:             flag(tests)
  Custom:             true
#  CompiledObject:     best
  Install:            false
  BuildDepends:       core,oUnit (>= 1.0.2)

Test test_runner
  Run$:               flag(tests)
  Command:            $test_runner
  WorkingDirectory:   lib_test

Document "core"
  Title:                Jane street's core library
  Type:                 ocamlbuild (0.2)
  BuildTools+:          ocamldoc
  XOCamlbuildPath:      lib
  XOCamlbuildLibraries: core

